<html>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>extramural venous invasion in colon adenocarcinoma</title>
<meta name="keywords" content="extramural, venous invasion, colon, adenocarcinoma">
<meta name="description" content="extramural venous invasion in colon adenocarcinoma">

<link rel="apple-touch-icon" sizes="180x180" href="https://images.patolojiatlasi.com/img/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://images.patolojiatlasi.com/img/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://images.patolojiatlasi.com/img/favicon-16x16.png">
<link rel="manifest" href="https://images.patolojiatlasi.com/img/site.webmanifest">

<div id="openseadragon1" style="width: 100%; height: 95%;"></div>
<script src="https://images.patolojiatlasi.com/openseadragon/openseadragon.min.js"></script>
<!-- <script src="openseadragon/openseadragon-scalebar.js"></script> -->
<script type="text/javascript">
    var viewer = OpenSeadragon({
        id: 'openseadragon1',
        prefixUrl: 'https://images.patolojiatlasi.com/openseadragon/images/',

        showHomeControl: false,
        showRotationControl: true,
        showNavigator: true,
        showFlipControl: true,
        navigatorBackground: 'rgb(240, 240, 240)',


        tileSources: {
            Image: {
                Url: './HE_files/', // name of image folder
                TileSize: '254', // see .dzi file
                Overlap: '1', // see .dzi file
                Format: 'jpeg', // see .dzi file
                ServerFormat: 'Default', // optional
                xmlns: 'http://schemas.microsoft.com/deepzoom/2009', // see .dzi file
                Size: {
                    Width: '92625', // see .dzi file
                    Height: '52349' // see .dzi file
                }
            }
        }
        // ,
        // tileSources: "yourwsi.dzi",
        // sequenceMode: false,
        // autoHideControls: true,
        // animationTime: 1.0,
        // blendTime: 0.6,
        // constrainDuringPan: true,
        // maxZoomPixelRatio: 1,
        // visibilityRatio: 1,
        // zoomPerScrolli: 1,
        // defaultZoomLevel: 1,
        // showReferenceStrip: true,
        // showNavigator:  true,
        // showFullPageControl: false 


    });

    /*     viewer.scalebar({
            minWidth: '100px',
            pixelsPerMeter: '1.98255e+06',
            fontFamily: 'Arial',
            backgroundColor: 'rgba(255, 255, 255, 0.5)',
            fontSize: 'small',
            barThickness: '2',
            xOffset: '10',
            yOffset: '10'
        }); */

        // Custom function to handle middle-click scrolling
//          function handleMiddleClickScroll(event) {
//            if (event.which === 2 || event.button === 4) { // Check for middle-click
//              event.preventDefault();
//              event.stopPropagation();
//
//              var delta = -event.deltaY || event.detail || -(event.wheelDelta || 0);
//              var viewportPoint = viewer.viewport.pointFromPixel(event.position);
//              viewer.viewport.zoomBy(viewer.viewport.deltaPointsFromPixels(delta, viewportPoint), viewportPoint);
//            }
//          }

          // Attach event listener to handle middle-click scrolling
//          document.getElementById('openseadragon1').addEventListener('mousedown', handleMiddleClickScroll, false);


//        // Override mouse handling behavior to enable middle-click scrolling
//        viewer.addHandler('canvas-click', function (event) {
//          if (event.quick && event.button === 1) { // Check for middle-click
//            event.preventDefaultAction = true;
//            event.stopHandlers = true;
//
//            var delta = -event.delta.y;
//            var viewportPoint = viewer.viewport.pointFromPixel(event.position);
//            viewer.viewport.zoomBy(viewer.viewport.deltaPointsFromPixels(delta, viewportPoint), viewportPoint);
//          }
//        });

//  // Custom function to handle middle-click scrolling
//  function handleMiddleClickScroll(event) {
//    if (event.button === 1) { // Check for middle-click
//      event.preventDefault();
//      event.stopPropagation();
//
//      var delta = -event.deltaY || event.detail || -(event.wheelDelta || 0);
//      var viewportPoint = viewer.viewport.pointFromPixel(event.position);
//      viewer.viewport.zoomBy(viewer.viewport.deltaPointsFromPixels(delta, viewportPoint), viewportPoint);
//    }
//  }
//
//  // Attach event listener to handle middle-click scrolling
//  document.addEventListener('mousedown', handleMiddleClickScroll, false);



//      // Custom function to handle middle-click scrolling
//      function handleMiddleClickScroll(event) {
//        if (event.button === 1) { // Check for middle-click
//          event.preventDefault();
//          event.stopPropagation();
//
//          var delta = -event.deltaY || event.detail || -(event.wheelDelta || 0);
//          var viewportPoint = viewer.viewport.pointFromPixel(event.position);
//          viewer.viewport.zoomBy(viewer.viewport.deltaPointsFromPixels(delta, viewportPoint), viewportPoint);
//        }
//      }
//
//      // Attach event listener to handle middle-click scrolling
//      document.addEventListener('mousedown', handleMiddleClickScroll, false);



  var trackerElement = viewer.container;
  var drag;

  function capturePointer(event) {
    if (OpenSeadragon.MouseTracker.havePointerCapture) {
      if (OpenSeadragon.MouseTracker.havePointerEvents) {
        // Can throw InvalidPointerId
        try {
          trackerElement.setPointerCapture(event.originalEvent.pointerId);
        } catch () {
          //
        }
      } else {
        trackerElement.setCapture(true);
      }
    }
  }

  function releasePointer(event) {
    if (OpenSeadragon.MouseTracker.havePointerCapture) {
      if (OpenSeadragon.MouseTracker.havePointerEvents) {
        // Can throw InvalidPointerId
        try {
          trackerElement.releasePointerCapture(event.originalEvent.pointerId);
        } catch () {
          //
        }
      } else {
        trackerElement.releaseCapture();
      }
    }
  }

  var mouseTracker = new OpenSeadragon.MouseTracker({
    element: trackerElement,
    nonPrimaryPressHandler: function (event) {
      if (event.button === 1) { // Middle
        capturePointer(event);
        drag = {
          lastPos: event.position.clone()
        };
      }
    },
    moveHandler: function (event) {
      if (drag) {
        var deltaPixels = drag.lastPos.minus(event.position);
        var deltaPoints = viewer.viewport.deltaPointsFromPixels(deltaPixels);
        viewer.viewport.panBy(deltaPoints);
        drag.lastPos = event.position.clone();
      }
    },
    nonPrimaryReleaseHandler: function (event) {
      if (event.button === 1) {
        releasePointer(event);
        drag = null;
      }
    }
  });
















        // Add a keydown event listener to the document
    document.addEventListener("keydown", function(event) {
      // Check if the pressed key is 'Z' (key code 90) to zoom in
      if (event.keyCode === 90) {
        // Zoom in
        viewer.viewport.zoomBy(1.2);
      }
      // Check if the pressed key is 'X' (key code 88) to zoom out
      else if (event.keyCode === 88) {
        // Zoom out
        viewer.viewport.zoomBy(0.8);
      }
    });
    
</script>

</html>
